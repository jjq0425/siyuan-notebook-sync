{"ID":"20251009102118-ov7p86j","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f427","id":"20251009102118-ov7p86j","title":"八股","type":"doc","updated":"20251012162505"},"Children":[{"ID":"20251009102119-bk79nfo","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20251009102119-bk79nfo","updated":"20251012162505"},"Children":[{"Type":"NodeText","Data":"大模型基础"}]},{"ID":"20251009153935-3my4s8g","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20251009153935-3my4s8g","updated":"20251012162505"},"Children":[{"Type":"NodeText","Data":"机制部分"}]},{"ID":"20251009153946-a1q9qdf","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20251009153946-a1q9qdf","updated":"20251012162505"},"Children":[{"Type":"NodeText","Data":"注意力"}]},{"ID":"20251009153412-yykcka0","Type":"NodeMathBlock","Properties":{"id":"20251009153412-yykcka0","updated":"20251009153923"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"Attention(Q,K,V)=softmax(\\frac{QK^T}{\\sqrt{d_k}})V"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20251009153923-8je37xh","Type":"NodeParagraph","Properties":{"id":"20251009153923-8je37xh","updated":"20251009171601"},"Children":[{"Type":"NodeText","Data":"注意力的过程?"}]},{"ID":"20251009154203-tuvpfcq","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20251009154203-tuvpfcq","updated":"20251009172100"},"Children":[{"ID":"20251009154205-tkdo68p","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20251009154205-tkdo68p","updated":"20251009154556"},"Children":[{"ID":"20251009154205-fglxmb0","Type":"NodeParagraph","Properties":{"id":"20251009154205-fglxmb0","updated":"20251009154556"},"Children":[{"Type":"NodeText","Data":"对于输入序列的每个位置，通过"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"点积"},{"Type":"NodeText","Data":"计算其与其他位置之间的相似度得分"}]}]},{"ID":"20251009154236-1a0l4zk","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20251009154236-1a0l4zk","updated":"20251009172100"},"Children":[{"ID":"20251009154236-cvyxp3j","Type":"NodeParagraph","Properties":{"id":"20251009154236-cvyxp3j","updated":"20251009172100"},"Children":[{"Type":"NodeText","Data":"然后对得分进行放缩处理，以防止梯度消失"}]}]},{"ID":"20251009171345-m7fwpby","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20251009171345-m7fwpby","updated":"20251009171426"},"Children":[{"ID":"20251009171345-80siu0h","Type":"NodeParagraph","Properties":{"id":"20251009171345-80siu0h","updated":"20251009171426"},"Children":[{"Type":"NodeText","Data":"将得分用"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"softmax"},{"Type":"NodeText","Data":"​函数转换为注意力权重，以便计算每个位置的加权和"}]}]}]},{"ID":"20251009154247-j478x3c","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20251009154247-j478x3c","updated":"20251009171533"},"Children":[{"ID":"20251009171532-qzorkai","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20251009171532-qzorkai","updated":"20251009171533"},"Children":[{"ID":"20251009171532-jkf4kl4","Type":"NodeParagraph","Properties":{"id":"20251009171532-jkf4kl4","updated":"20251009171533"},"Children":[{"Type":"NodeText","Data":"使用注意力权重对输入序列中的所有位置进行加权求和，得到每个位置的自注意输出。"}]}]}]},{"ID":"20251009154247-r0cts7t","Type":"NodeParagraph","Properties":{"id":"20251009154247-r0cts7t","updated":"20251009154247"}},{"ID":"20251009154247-77nyjqd","Type":"NodeParagraph","Properties":{"id":"20251009154247-77nyjqd","updated":"20251012162256"},"Children":[{"Type":"NodeText","Data":"为什么要除以dk？能换成别的数吗？"}]},{"ID":"20251012162135-qza7x2g","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20251012162135-qza7x2g","updated":"20251012162149"},"Children":[{"ID":"20251012162135-m9d37ip","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20251012162135-m9d37ip","updated":"20251012162149"},"Children":[{"ID":"20251012162135-49g3z9i","Type":"NodeParagraph","Properties":{"id":"20251012162135-49g3z9i","updated":"20251012162149"},"Children":[{"Type":"NodeText","Data":"避免softmax梯度消失：当dk（Query/Key的"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"维度"},{"Type":"NodeText","Data":"）"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"较大"},{"Type":"NodeText","Data":"时，"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"Q和K的点积结果会随dk增大而显著变大"},{"Type":"NodeText","Data":"，代入softmax后易趋近于0或1，导致softmax进入饱和区，梯度趋近于0，无法有效更新参数。除以dk能缩小点积规模，让softmax输出更平缓，保证梯度正常传递。"}]}]},{"ID":"20251012162135-u74fz88","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20251012162135-u74fz88","updated":"20251012162135"},"Children":[{"ID":"20251012162135-9gctvb8","Type":"NodeParagraph","Properties":{"id":"20251012162135-9gctvb8","updated":"20251012162135"},"Children":[{"Type":"NodeText","Data":"稳定向量模长与权重分布：假设Q、K的元素服从均值0、方差1的分布，其点积的期望约为dk，会随dk变化而波动。除以dk后，可将点积的期望控制在较稳定的范围（如接近1），避免因dk差异导致attention权重分布差异过大，确保不同维度下attention计算的一致性。"}]}]}]},{"ID":"20251012161559-0gkmch8","Type":"NodeParagraph","Properties":{"id":"20251012161559-0gkmch8","updated":"20251012161559"}},{"ID":"20251012162459-51hk64o","Type":"NodeParagraph","Properties":{"id":"20251012162459-51hk64o","updated":"20251012162505"},"Children":[{"Type":"NodeText","Data":"能不能换成别的数？"}]},{"ID":"20251012162505-4t76glv","Type":"NodeParagraph","Properties":{"id":"20251012162505-4t76glv","updated":"20251012162505"}},{"ID":"20251012162459-d2syp3v","Type":"NodeParagraph","Properties":{"id":"20251012162459-d2syp3v","updated":"20251012162459"}},{"ID":"20251012161559-sq60ktt","Type":"NodeParagraph","Properties":{"id":"20251012161559-sq60ktt","updated":"20251012162455"},"Children":[{"Type":"NodeText","Data":"Attention中Q和K权重相等可以吗？"}]},{"ID":"20251009171816-5cabewt","Type":"NodeParagraph","Properties":{"id":"20251009171816-5cabewt","updated":"20251009171816"}}]}